## 通过日志找出慢的依赖服务或者系统

- 通过`jstack`查看阻塞线程定位到问题。

1. Rabbitmq 队列堆积问题： 当时解决的方案，切换成http服务为主，mq服务为辅。

2. 服务超时：执行了keys 命令，执行了10万条历史记录的批量删除，阻塞了redis

3. 服务超时：开发阶段日志输出到线上,导致日志量大增，从而出现了`logback的锁阻塞`，日志信息与结果不一致是因为打印日志不精准，日志
记录的时间不只是请求服务的时间，还包括一些别的逻辑,比如有一行是写日志的代码，刚好写日志出现了阻塞，导致时间超时。
引起logback写日志锁是刚上线的程序导致的，先回滚代码，后续精细化日志打印和调高日志级别到info解决
   
### 总结
- 响应慢，通常是出现了锁阻塞和依赖服务或者系统响应慢导致的，通过jstack可快速定位锁阻塞的问题，通过打印依赖服务或者系统的访问时间到日志，则可以通过
日志快速定位外部服务或者系统问题
  
- 如果出现问题前进行过上线动作，则立即通过jstack打印jvm线程信息并保存，同时评估是否要回滚，如果可以回滚，立即回滚，然后在通过线程信息和回滚前的日志信息进行原因查找

- 在一定时间内没有定位到问题，则 需要进行问题定位和降级、替代方案并行，在确定时间内方案确定和准备
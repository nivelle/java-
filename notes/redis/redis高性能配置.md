### Redis 内部的阻塞式操作:

[![ygVumd.md.jpg](https://s3.ax1x.com/2021/02/16/ygVumd.md.jpg)](https://imgchr.com/i/ygVumd)

1. 和客户端交互时的阻塞点

- 复杂度高的增删改查操作会阻塞 Redis
  
  (1). 集合全量查询和聚合操作

````
复杂度是否为高,评判标准是复杂度是否为O(n)
````
  (2). bigkey 删除操作、清空数据库

````
删除操作的本质是要释放键值对占用的内存空间,释放内存只是第一步，为了更加高效地管理内存空间，在应用程序释放内存时，操作系统需要把释放掉的内存块插入一个空闲内存块的链表，以便后续进行管理和再分配。
这个过程本身需要一定时间，而且会阻塞当前释放内存的应用程序，所以，如果一下子释放了大量内存，空闲内存块链表操作时间就会增加，相应地就会造成 Redis 主线程的阻塞。
````

2. 和磁盘交互时的阻塞点

````
Redis 直接记录 AOF 日志时，会根据不同的写回策略对数据做落盘保存。一个同步写磁盘的操作的耗时大约是 1～2ms，如果有大量的写操作需要记录在 AOF 日志中，并同步写回的话，就会阻塞主线程了。这就得到了 Redis 的第四个阻塞点了：AOF 日志同步写。
````

### 二叉查找树

#### 二叉查找树特征

1. 任意节点左子树不为空,则左子树的值均小于根节点的值;

2. 任意节点右子树不为空,则右子树的值均大于于根节点的值;

3. 任意节点的左右子树也分别是二叉查找树;

4. 没有键值相等的节点;

#### 二叉查找树的局限性如果节点为有序节点，会退化成连表查找。

"平衡": 其实就是让整颗树左右看起来比较对称，比较平衡，不出现左子树很高，右子树很矮的情况。这样整棵树相对高度低，相应的插入、删除，查找操作更高效。

### 平衡二叉树也就是 AVL 树

AVL树是带有平衡条件的二叉查找树，一般是用平衡因子差值判断是否平衡并通过旋转来实现平衡，左右子树树高不超过1，和红黑树相比，它是严格的**平衡二叉树**，平衡条件必须满足（所有节点的左右子树高度差不超过1）。
不管我们是执行插入还是删除操作，只要不满足上面的条件，就要通过旋转来保持平衡，而旋转是非常耗时的，由此我们可以知道AVL树适合用于插入删除次数比较少，但查找多的情况。

#### 局限性

由于维护这种高度平衡所付出的代价比从中获得的效率收益还大，故而实际的应用不多，更多的地方是用追求局部而不是非常严格整体平衡的红黑树。当然，如果应用场景中对插入删除不频繁，只是对查找要求较高，那么AVL还是较优于红黑树。

### B- 树

- 平衡的多路搜索树，在文件系统和数据库系统中多使用B树实现。

- 每一个节点最多包含M个字节点，M称为树的阶

- 每个节点中包含了关键字和子节点指针

- 如果一个节点包含了x个关键字，那么指针数是x+1

- 所有叶子节点位于同一层

[![s0DLZR.md.jpg](https://s3.ax1x.com/2021/01/15/s0DLZR.md.jpg)](https://imgchr.com/i/s0DLZR)

### 红黑树（不严格的二叉查找树）

- 红黑树也是平衡二叉树，但每个节点有一个存储位表示节点的颜色，可以是红或黑。
- 通过对任何一条从根到叶子的路径上各个节点着色的方式的限制，红黑树确保没有一条路径会比其它路径长出两倍，因此，红黑树是一种弱平衡二叉树（由于是弱平衡，可以看到，在相同的节点情况下，AVL树的高度<
  =红黑树），相对于要求严格的AVL树来说，它的旋转次数少，所以对于搜索，插入，删除操作较多的情况下，用红黑树

#### 红黑树的特征

1. 每个节点非红即黑
2. 根节点是黑的;
3. 每个叶节点（叶节点即树尾端NULL指针或NULL节点）都是黑的;
4. 如图所示，如果一个节点是红的，那么它的两儿子都是黑的;
5. 对于任意节点而言，其到叶子点树NULL指针的每条路径都包含相同数目的黑节点;
6. 每条路径都包含相同的黑节点;

#### 应用

1. 广泛用于C ++的STL中，地图是用红黑树实现的;
2. Linux的的进程调度，用红黑树管理进程控制块，进程的虚拟内存空间都存储在一颗红黑树上，每个虚拟内存空间都对应红黑树的一个节点，左指针指向相邻的虚拟内存空间，右指针指向相邻的高地址虚拟内存空间;
3. IO多路复用的epoll采用红黑树组织管理sockfd，以支持快速的增删改查;
4. Nginx中用红黑树管理定时器，因为红黑树是有序的，可以很快的得到距离当前最小的定时器;
5. Java的TreeMap的实现;

### B+树

- 非叶子节点仅保存关键字，不存数据记录，记录相关的信息都在叶子节点

- 非叶子节点的关键字会同时存在子节点中，并且是在子节点中所有关键字的最大（或者最小）

- 所有关键字都在叶子节点出现，叶子节点构成一个有序列表，而且叶子节点本身按照关键字的大小从小到大顺序链接

[![s0DzRO.md.jpg](https://s3.ax1x.com/2021/01/15/s0DzRO.md.jpg)](https://imgchr.com/i/s0DzRO)

### 数据库索引为什么不适合二叉树

1. 平衡二叉树必须满足所有截断的左右子树高度差不超过1。执行插入还是删除操作只要不满足这个条件，就要通过旋转来保持平衡，而旋转是非常耗时的，所以AVL树仅适合用于查找多的情况

2. 二叉树的数据结构，会导致深度比较深，这种瘦高的特性，加大了平均查询磁盘IO次数，随着数据量增多，查询效率会受到影响

### B+ 树和B树在构造和查询性能上的差异

1. B+ 树的非叶子节点不直接保存数据，任何关键字查询都走一条从根节点到叶子节点的查询路线，路径长度一样所以查询效率更加稳定;

2. B+ 树非叶子节点不保存数据，所以一次IO可以加载更多的节点到内存中，相对IO次数更低，所以磁盘读写代价更低

3. B+ 树数据都存储在叶子节点，非叶子节点均为索引，故方便扫库，只需要扫一遍叶子节点即刻，但B树因为非叶子节点还存储着数据，我们要得到具体的数据，需要进行一次中序遍历来扫，所以B+树更适合在区间查询的情况。